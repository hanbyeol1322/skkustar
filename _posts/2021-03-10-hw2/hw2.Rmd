---
title: "AmesHousing"
description: |
  응용통계학 hw2
author:
  - name: hanbyeol
    url: {}
date: 03-10-2021
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=TRUE}
library(tidyverse)
library(AmesHousing)
library(ggplot2)
```

# 1. Heating QC

난방시설이 잘 되어있을수록 집 값이 높지 않을까? 난방시설을 그룹화해서 평균 집 값을 보자!

```{r}
ames_raw %>% 
  group_by(`Heating QC`) %>%
  summarise(across(SalePrice,mean,na.rm=TRUE))
```

난방시설의 quality가 좋을수록 평균 집 가격이 높다는 것이 확인되었다. 그럼 boxplot을 이용해서 가격차이가 얼마나 나는지 시각적으로 확인해보자.

```{r}
ggplot(ames_raw,aes(x=`Heating QC`, y=SalePrice))+geom_boxplot(outlier.shape = NA)
```

또한 집이 최신에 지어질 수록 난방시절이 좋을 것 같다고 생각하고 각 quality별로 최대 년도를 보았다.

```{r}
ames_raw %>% 
  group_by(`Heating QC`) %>%
  summarise(across(`Year Built`,max,na.rm=TRUE))
```

확인결과 최근에 지어질수록 난방시설이 좋아지고 집 가격이 올라갈 것이라고 생각하고 **ggplot** 을 이용하여 연도별 sale price에 대한 난방시설 그래프를 그려보자.

**Step1. 그래프를 그릴 백지를 준비한다.**

```{r}
p <- ggplot(ames_raw)
p
```

**Step2. 그래프의 축을 정해주고 난방시설의 quality를 그룹화하여 각각 다른 색의 point로 표현한다.**

```{r}
p <- ames_raw %>% 
  group_by(`Heating QC`) %>%
  ggplot(aes(x=`Year Built`,y=SalePrice)) + 
  geom_point(aes(color=as_factor(`Heating QC`),alpha=0.3))
p
```

**Step3. point의 구분이 쉽도록 색을 지정해주며, 범례의 이름을 수정해준다.**

```{r}
p <- p + 
  scale_color_brewer(palette = "Set1",
                     labels = c("Fair", "Typical", "Excellent", "Good", "Poor"))+ 
  scale_alpha_identity(0.3)
p
```

**Step4. 범례의 제목을 바꾸고 위치를 조정한다.**

```{r}
hqc <- guide_legend(title = "Heating Quality and Condition", nrow = 5)
p <- p + 
  guides(color = hqc) +
  theme(legend.position = "right")
p
```

**Step5. 위 그래프들을 난방 종류에 따라 나누어본다.**

```{r}
p <- p + facet_wrap('Heating')
p
```

난방 종류별로 나누어본 결과 난방시설이 Excellent(초록색점)인 것은 모두 GasA(Gas forced warm air furnace를 사용하고 있는 것을 알 수 있다. 그럼 AmesHousing dataset을 GasA인 것만 필터링하여 좀 더 살펴 보자.

# 2. GasA
